<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title><%- opts.title %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <% opts.css.forEach(function (href) {
      %><link href="<%= href %>" rel="stylesheet"><%
    }); %>
    <script>examples=<%- JSON.stringify(opts.examples) %>;</script>
    <% opts.js.forEach(function (src) {
      %><script src="<%= src %>"></script><%
    }); %>
  </head>
  <body>
    <header>
      <a href="/" class="logo">
        <img src="<%= opts.logo %>" alt="<%= opts.title %>" height="32"> <%= opts.title %>
      </a>
      <nav>
        <% menu(list, 1) %>
      </nav>
      <menu>
        <% opts.nav.forEach(function(link) { %>
          <a href="<%= link.url %>" target="_blank"><%= link.name %></a>
        <% }); %>
      </menu>
      <footer>
        Last modified <%- lastModified() %>
      </footer>
    </header>

    <main class="three-fourths column markdown-body">
      <% sections(list, 3) %>
    </main>

    <script src="prism.js?871234"></script>
    <script src="examples.js?873428"></script>
    <script src="script.js?02359872"></script>
    <script src="anchor.min.js?225234"></script>
    <script src="interact.min.js?8552934"></script>
  </body>
</html>

<%
function menu(children, depth) {
  %>
    <% if (depth < 3) children.sort(sort).forEach(function (child) {
      if (child.name) {
        if (depth < 2) {modifier = "heading";}
        if (depth > 1) {modifier = "item";}
        %>
        <a class="menu-<%- modifier %>" href="#<%- child.name %>"><span><%= child.title %></span></a>
        <% if (child.children) menu(child.children, depth + 1) %>
        <%
      }
    }); %>
  <%
}

function sections(children, depth) {
  depth = Math.max(Math.min(depth, 6), 1);

  children.sort(sort).forEach(function (child) {
    %>
    <section<% if (child.name) { %> id="<%= child.name %>"<% } %>>
      <% if (child.title) { %><%- '<h' + (depth - 1) + ' class="page-title">' %><%= child.title %><%- '</h' + (depth - 1) + '>' %><% } %>

      <div class="markdown-body">
        <%- child.content %>
        <% if (child.children) sections(child.children, depth + 1) %>
      </div>
    </section>
    <%
  });
}

function lastModified() {
  var now = new Date();

  var day = 'Sunday Monday Tuesday Wednesday Thursday Friday Saturday'.split(' ')[now.getDay()];

  var month = 'January February March April May June July August September October November December'.split(' ')[now.getMonth()];

  return day + ', ' + now.getDate() + ' ' + month + ' ' + now.getFullYear() + ' ' + now.getHours() + ':' + ('0' + now.getMinutes()).slice(-2);
}

function sort(childA, childB) {
  return (childA.order || 0) - (childB.order || 0);
}

%>
